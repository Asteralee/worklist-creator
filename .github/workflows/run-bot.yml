name: Run AsteraBot

# Manual trigger
on:
  workflow_dispatch:
    inputs:
      dry_run:
        description: "If true, show pages to add but do not edit Wikipedia"
        required: true
        default: "true"

jobs:
  seed-bot:
    runs-on: ubuntu-latest

    env:
      # GitHub Secrets for bot login
      WIKI_USER: ${{ secrets.WIKI_BOT_USERNAME }}
      WIKI_PASS: ${{ secrets.WIKI_BOT_PASSWORD }}

      # Worklist page
      WORKLIST_TITLE: "User:YourBot/Worklists/Orphaned_with_2+_backlinks"

      # JSON file in repo
      QUARRY_JSON_FILE: "quarry-101099-orphaned-articles-with-more-than-two-incoming-links-retest-run1069296 (1).json"

      # Dry-run toggle (from workflow input)
      DRY_RUN: ${{ github.event.inputs.dry_run }}

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: pip install requests

      - name: Run Seeder Bot
        run: |
          if [ "$DRY_RUN" = "true" ]; then
              echo "Running in dry-run mode: will show pages but not edit Wikipedia"
          fi
          python seed_bot.py
